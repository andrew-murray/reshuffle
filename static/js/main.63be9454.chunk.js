(this.webpackJsonpreshuffle=this.webpackJsonpreshuffle||[]).push([[0],{156:function(e,t,n){},157:function(e,t,n){},233:function(e,t,n){"use strict";n.r(t);var o={};n.r(o);var a=n(4),r=n(0),i=n.n(r),s=n(15),c=n.n(s),l=(n(156),n(38)),h=n(39),u=n(41),p=n(40),b=(n(157),n(17)),j=n(65),d=n(286),f=n(139),v=n(287),O=n(288),m=n(281),y=n(62),g=n(235),x=n(5),k=n(69),C=n(279),w=n(282),S=n(289),P=n(272),_=n(280),E=n(276),A=n(277),D=n(275);var F=function(e){var t=i.a.useState(""),n=Object(k.a)(t,2),o=n[0],r=n[1],s=function(){e.onConfirm(o),r("")};return Object(a.jsxs)(P.a,{open:e.open,onClose:e.onCancel,"aria-labelledby":"form-dialog-title",children:[Object(a.jsx)(D.a,{id:"form-dialog-title"}),Object(a.jsxs)(E.a,{children:[Object(a.jsx)(A.a,{children:e.text}),Object(a.jsx)(S.a,{margin:"dense",id:"name",fullWidth:!0,onChange:function(e){r(e.target.value)},onKeyDown:function(e){13===e.keyCode&&(e.preventDefault(),s())},autoFocus:!0})]}),Object(a.jsxs)(_.a,{children:[Object(a.jsx)(m.a,{onClick:e.onCancel,variant:"contained",children:"Cancel"}),Object(a.jsx)(m.a,{onClick:s,variant:"contained",children:"Confirm"})]})]})};var M=function(e){return Object(a.jsxs)(P.a,{open:e.open,onClose:e.onClose,children:[Object(a.jsx)(D.a,{id:"text-dialog-title",children:e.title}),Object(a.jsx)(E.a,{children:Object(a.jsx)(A.a,{children:e.children})}),Object(a.jsx)(_.a,{children:Object(a.jsx)(m.a,{onClick:e.onClose,variant:"contained",children:"ok"})})]})},R=n(283),T=n(136),N=n.n(T),I={position:"absolute",bottom:0,right:0};var B=function(e){var t=Object(b.f)(),n=i.a.useState(!1),o=Object(k.a)(n,2),r=o[0],s=o[1],c=i.a.useState(!1),l=Object(k.a)(c,2),h=l[0],u=l[1],p=[{text:"Create Room",onClick:e.onCreate},{text:"Join Room",onClick:function(){s(!0)}},{text:"Practice",onClick:function(){t.push("/othello/practice")}}].map((function(e){return Object(a.jsx)(w.a,{children:Object(a.jsx)(m.a,{variant:"contained",style:{width:"100%"},"aria-label":e.text,onClick:e.onClick,children:e.text})},e.text)}));return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(C.a,{"aria-label":"menu",children:p}),Object(a.jsx)(F,{open:r,text:"Enter room name",onConfirm:function(e){e&&(t.push("/othello/room/"+e),s(!1))},onCancel:function(){s(!1)}}),Object(a.jsx)(M,{open:h,title:"Attributions",onClose:function(){u(!1)},children:Object(a.jsxs)(y.a,{children:["reshuffle uses sounds from ",Object(a.jsx)(j.b,{to:{pathname:"https://www.zapsplat.com/"},target:"_blank",children:"zapsplat"})]})}),Object(a.jsx)("div",{style:I,children:Object(a.jsx)(R.a,{onClick:function(){u(!0)},children:Object(a.jsx)(N.a,{color:"primary"})})})]})},W=n(21),K=n(284),L=n(290),U=n(278),H=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(e){var o;return Object(l.a)(this,n),(o=t.call(this,e)).state={currentMessage:""},o}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=Object(W.a)(Array(this.props.messages.length).keys()).map((function(t){return Object(a.jsx)(w.a,{children:Object(a.jsx)(K.a,{primary:e.props.messages[t]})},"message-"+t.toString())})),n=function(t){if(e.state.currentMessage&&e.props.onSend){var n=e.state.currentMessage;e.setState({currentMessage:""},(function(){e.props.onSend(n)}))}t.preventDefault()},o=Object.assign(Object.assign({},{display:"flex",flexDirection:"row",alignItems:"flex-end"}),this.props.style);return Object(a.jsxs)(L.a,{variant:"permanent",anchor:"right",style:o,className:this.props.className,children:[Object(a.jsx)(g.a,{style:{overflow:"auto",flexGrow:1,display:"flex",flexDirection:"column-reverse",width:o.width?o.width:"inherit"},children:Object(a.jsx)(C.a,{"aria-label":"menu",children:t})}),Object(a.jsx)("form",{onSubmit:n,children:Object(a.jsxs)("div",{style:{display:"flex"},children:[Object(a.jsx)(U.a,{inputProps:{"aria-label":"enter message"},value:this.state.currentMessage,onChange:function(t){e.setState({currentMessage:t.target.value})},style:{flexGrow:1}}),Object(a.jsx)(m.a,{variant:"contained",color:"primary",onClick:n,style:{alignSelf:"flex-end"},children:"Send"})]})})]})}}]),n}(i.a.Component),G=n(70),V=n(101),z={empty:0,black:1,white:2},J=[[-1,0],[-1,1],[0,1],[1,1],[1,0],[1,-1],[0,-1],[-1,-1]],q=function(e){if(e!==z.black&&e!==z.white)throw Error("Invalid player provided to opponentForPlayer: "+e.toString());return e===z.black?z.white:z.black},Y=function(e,t){return e.length>=1&&0<=t[0]&&t[0]<e.length&&0<=t[1]&&t[1]<e[0].length},Q=function(e,t){return[e[0]+t[0],e[1]+t[1]]},X=function(e,t){return[e[0]*t,e[1]*t]},Z=function(e,t){return e[0]!==t[0]?e[0]<t[0]?-1:1:e[1]!==t[1]?e[1]<t[1]?-1:1:0},$=function(e,t,n){if(e[n[0]][n[1]]===z.white||e[n[0]][n[1]]===z.black)return{};var o,a=q(t),r=Math.max(e.length,e[0].length),i=[],s=Object(V.a)(J);try{for(s.s();!(o=s.n()).done;){var c=o.value,l=Q(n,c);if(Y(e,l)&&e[l[0]][l[1]]===a){for(var h=null,u=2;u<r;++u){var p=Q(n,X(c,u));if(Y(e,p)){if(e[p[0]][p[1]]===t){h=u;break}if(e[p[0]][p[1]]===a)continue;break}break}if(h)for(var b=1;b<h;++b){var j=Q(n,X(c,b));i.push({position:j,outcome:t})}}}}catch(d){s.e(d)}finally{s.f()}return 0===i.length?[]:(i.push({position:n,outcome:t}),i.sort((function(e,t){return Z(e.position,t.position)})),i)},ee=function(e,t,n){return!!Y(e,n)&&(e[n[0]][n[1]]===z.empty&&$(e,t,n).length>0)};exports.boardsEqual=function(e,t){if(e.length!==t.length||e[0].length!==t[0].length)return!1;for(var n=0,o=Object(W.a)(Array(e.length).keys());n<o.length;n++)for(var a=o[n],r=0,i=Object(W.a)(Array(t[0].length).keys());r<i.length;r++){var s=i[r];if(e[a][s]!==t[a][s])return!0}return!1},exports.canPlay=ee,exports.changesForAllPositions=function(e,t){if(0===e.length)return[];for(var n=[],o=0,a=Object(W.a)(Array(e.length).keys());o<a.length;o++)for(var r=a[o],i=0,s=Object(W.a)(Array(e[0].length).keys());i<s.length;i++){var c=s[i],l=$(e,t,[r,c]);l.length>0&&n.push({position:[r,c],changeset:l})}return n},exports.comparePosition=Z,exports.countCellsForRole=function(e,t){for(var n=0,o=0,a=Object(W.a)(Array(e.length).keys());o<a.length;o++)for(var r=a[o],i=0,s=Object(W.a)(Array(e[0].length).keys());i<s.length;i++){var c=s[i];e[r][c]===t&&n++}return n},exports.createBoardStateWithMove=function(e,t,n){var o,a=$(e,n,t),r=Object(W.a)(Array(e.length).keys()).map((function(t){return Array.from(e[t])})),i=Object(V.a)(a);try{for(i.s();!(o=i.n()).done;){var s=o.value;r[s.position[0]][s.position[1]]=s.outcome}}catch(c){i.e(c)}finally{i.f()}return r},exports.createEmptyBoardState=function(e,t){var n=z.empty;return Object(W.a)(Array(e).keys()).map((function(e){return Array(t).fill(n)}))},exports.createInitialBoardState=function(){var e=z.empty,t=z.white,n=z.black;return[[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,n,t,e,e,e],[e,e,e,t,n,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e],[e,e,e,e,e,e,e,e]]},exports.changesFromPlay=$,exports.isGameCoordinate=Y,exports.opponentForPlayer=q,exports.playerCanPlay=function(e,t){for(var n=0,o=Object(W.a)(Array(e.length).keys());n<o.length;n++)for(var a=o[n],r=0,i=Object(W.a)(Array(e[0].length).keys());r<i.length;r++){var s=i[r];if(ee(e,t,[a,s]))return!0}return!1},exports.labels=z;var te=o,ne=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={hovered:!1},e}return Object(h.a)(n,[{key:"render",value:function(){var e,t=this,n=function(){t.setState({hovered:!0})},o=function(){t.setState({hovered:!1})},r=function(e,n){var o=t.props.player===te.labels.white?"white":"black";return e===te.labels.white?"white":e===te.labels.black?"black":n?o:t.props.impossibleColor}(this.props.gameState,this.props.possible),s=(e=this.props.gameState)===te.labels.white?"white":e===te.labels.black?"black":"#b87340",c=r!==s;return Object(a.jsxs)(i.a.Fragment,{children:[Object(a.jsx)(G.c,{y:this.props.y,x:this.props.x,width:this.props.width,height:this.props.height,fill:"#b87340",shadowBlur:5,onClick:this.props.onClick,onTap:this.props.onClick,onDblTap:this.props.onClick,onMouseOver:n,onMouseOut:o}),Object(a.jsx)(G.a,{y:this.props.y+this.props.height/2,x:this.props.x+this.props.width/2,width:.85*this.props.width,height:.85*this.props.height,fill:this.state.hovered?r:s,opacity:c&&this.state.hovered?.5:void 0,onClick:this.props.onClick,onTap:this.props.onClick,onDblTap:this.props.onClick,onMouseOver:n,onMouseOut:o})]})}}]),n}(i.a.Component),oe=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){return Object(l.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this,t=[];this.props.showMovesForPlayer&&(t=te.changesForAllPositions(this.props.game,this.props.showMovesForPlayer));var n=this.props.width,o=this.props.height,r=function(r,i,s){var c=n/8,l=o/8,h=r*l,u=i*c,p=function(e,n){return e===te.labels.empty&&t.filter((function(e){return e.position[0]===n[0]&&e.position[1]===n[1]})).length>0}(s,[r,i]),b=p?function(t){!function(t,n,o){e.props.onMove&&o&&e.props.onMove({position:[t,n]})}(r,i,!0)}:void 0;return Object(a.jsx)(ne,{width:c,height:l,boardPosition:[r,i],player:e.props.showMovesForPlayer,x:u,y:h,gameState:s,possible:p,onClick:b},"othello-cell-"+r.toString()+"-"+i.toString())},i=Object(W.a)(Array(8).keys()),s=Object(W.a)(Array(8).keys());return Object(a.jsx)(G.d,{width:n,height:o,style:this.props.style,children:Object(a.jsx)(G.b,{children:i.map((function(t){return s.map((function(n){return r(t,n,e.props.game[t][n])}))}))})})}}]),n}(r.Component),ae=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={game:te.createInitialBoardState(),player:te.labels.black},e}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return Object(a.jsx)(oe,{width:400,height:400,game:this.state.game,showMovesForPlayer:this.state.player,onMove:function(t){if(t.position){var n=te.createBoardStateWithMove(e.state.game,t.position,e.state.player),o=te.opponentForPlayer(e.state.player),a=te.playerCanPlay(n,o)?o:e.state.player;e.setState({game:n,player:a})}}})}}]),n}(r.Component),re=n(285),ie=n(291),se=n(102),ce=n.n(se),le=Object(re.a)((function(e){return{root:{display:"flex",justifyContent:"center",flexWrap:"wrap",listStyle:"none",padding:e.spacing(.5),margin:0},chip:{margin:e.spacing(.5)}}}));var he=function(e){var t=le(),n=e.role===te.labels.black,o=te.labels.black===e.active,r=te.labels.white===e.active,i=n&&o||!n&&r,s=!n&&o||n&&r;return Object(a.jsxs)("div",{className:t.root,style:{margin:"1vh"},children:[Object(a.jsx)(ie.a,{icon:Object(a.jsx)(ce.a,{style:{color:n?"#000000":"#ffffff"}}),label:n?e.blackScore:e.whiteScore,className:t.chip,style:i?void 0:{opacity:"50%"}},"score-1"),Object(a.jsx)(ie.a,{icon:Object(a.jsx)(ce.a,{style:{color:n?"#ffffff":"#000000"}}),label:n?e.whiteScore:e.blackScore,className:t.chip,style:s?void 0:{opacity:"50%"}},"score-2")]})},ue=n(138),pe=n.n(ue),be=(new URL(window.location.origin),Object({NODE_ENV:"production",PUBLIC_URL:"/reshuffle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SERVER_ENDPOINT?Object({NODE_ENV:"production",PUBLIC_URL:"/reshuffle",WDS_SOCKET_HOST:void 0,WDS_SOCKET_PATH:void 0,WDS_SOCKET_PORT:void 0,FAST_REFRESH:!0}).SERVER_ENDPOINT:"wss://reshuffle.herokuapp.com/"),je=pe()(be),de=new Audio("/zapsplat_impacts_wood_thin_small_panel_knock_hit_lite_muted_004_39796.mp3"),fe=function(e){Object(u.a)(n,e);var t=Object(p.a)(n);function n(){var e;Object(l.a)(this,n);for(var o=arguments.length,a=new Array(o),r=0;r<o;r++)a[r]=arguments[r];return(e=t.call.apply(t,[this].concat(a))).state={messages:[],board:null,role:null,activePlayer:null,status:null,joinedRoom:null},e}return Object(h.a)(n,[{key:"connectToRoom",value:function(e){this.state.joinedRoom!==e&&this.setState({joinedRoom:e},(function(){je.emit("chat.join",e),je.emit("othello.join",e)}))}},{key:"componentDidMount",value:function(){var e=this;this.connectToRoom(this.props.roomID),je.on("chat.message",(function(t){e.setState((function(e,n){return{messages:e.messages.concat(t)}}))})),je.on("othello.update",(function(t){e.setState((function(e,n){var o=!e.board||!e.activePlayer||!e.role||!e.status;return o||t.role!==e.role||t.activePlayer!==e.activePlayer||t.status!==e.status||!te.boardsEqual(e.board,t.board)?(o||de.play(),{board:t.board,activePlayer:t.activePlayer,role:t.role,status:t.status}):{}}))}))}},{key:"componentDidUpdate",value:function(){this.connectToRoom(this.props.roomID)}},{key:"componentWillUnmount",value:function(){je.off("chat.message"),je.off("othello.update")}},{key:"render",value:function(){var e=this,t=this.state.board?te.countCellsForRole(this.state.board,te.labels.white):0,n=this.state.board?te.countCellsForRole(this.state.board,te.labels.black):0,o="active"===this.state.status,r=this.state.role===this.state.activePlayer?this.state.role:null,i=null===this.state.activePlayer?{opacity:"50%"}:void 0;return Object(a.jsxs)("div",{className:this.props.classes.root,children:[Object(a.jsxs)("main",{className:this.props.classes.content,children:[Object(a.jsx)(oe,{width:400,height:400,game:null===this.state.board?te.createEmptyBoardState(8,8):this.state.board,showMovesForPlayer:r,onMove:function(e){e.position&&je.emit("othello.move",e)},style:i}),Object(a.jsx)(he,{role:this.state.role,active:this.state.activePlayer,whiteScore:t,blackScore:n}),this.state.role?Object(a.jsxs)("div",{style:{padding:"1vh"},children:[Object(a.jsx)(m.a,{variant:"contained",onClick:function(){null!==e.state.role&&je.emit("othello.swap")},disabled:o,color:"primary",children:" Swap "}),Object(a.jsx)(m.a,{variant:"contained",onClick:function(){null!==e.state.role&&je&&je.emit("othello.reset")},disabled:o,color:"primary",children:" Reset "}),Object(a.jsx)(m.a,{variant:"contained",onClick:function(){null!==e.state.role&&je.emit("othello.concede")},disabled:!o,color:"primary",children:" Concede "})]}):Object(a.jsx)(g.a,{style:{padding:"1vh"},children:Object(a.jsx)(y.a,{children:"You are observing."})})]}),Object(a.jsx)(H,{messages:this.state.messages,onSend:function(e){je.emit("chat.message",e)},style:{width:"300px"}})]})}}]),n}(i.a.Component),ve=Object(x.a)((function(e){return{root:{display:"flex"},content:{flexGrow:1,padding:e.spacing(3)},chatDrawer:{width:300}}}))(fe);function Oe(){var e=Object(b.f)(),t=Object(d.a)("(prefers-color-scheme: dark)"),n=i.a.useMemo((function(){return Object(f.a)({palette:{type:t?"dark":"light"}})}),[t]);return i.a.useEffect((function(){return je.on("room.created",(function(t){e.push("othello/room/"+t)})),function(){je.off("room.created")}})),Object(a.jsxs)(v.a,{theme:n,children:[Object(a.jsx)(O.a,{}),Object(a.jsx)("div",{className:"App",children:Object(a.jsxs)(b.c,{children:[Object(a.jsx)(b.a,{exact:!0,path:"/",children:Object(a.jsx)(B,{onCreate:function(){je.emit("chat.create")}})}),Object(a.jsx)(b.a,{exact:!0,path:"/othello/practice",children:Object(a.jsx)(ae,{})}),Object(a.jsx)(b.a,{path:"/othello/room/:roomID/",component:function(e){return Object(a.jsx)(ve,{roomID:e.match.params.roomID})}})]})})]})}var me=function(){return Object(a.jsx)(j.a,{children:Object(a.jsx)(Oe,{})})},ye=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,292)).then((function(t){var n=t.getCLS,o=t.getFID,a=t.getFCP,r=t.getLCP,i=t.getTTFB;n(e),o(e),a(e),r(e),i(e)}))};c.a.render(Object(a.jsx)(i.a.StrictMode,{children:Object(a.jsx)(me,{})}),document.getElementById("root")),ye()}},[[233,1,2]]]);
//# sourceMappingURL=main.63be9454.chunk.js.map